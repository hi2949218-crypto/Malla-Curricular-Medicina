<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Medicina FMED ‚Äì Organizador Completo</title>

<!-- FullCalendar -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/main.min.css" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:Segoe UI, sans-serif;
  background:#f2f6fb;
}
header{
  background:#0b3c5d;
  color:white;
  padding:15px;
  text-align:center;
}
nav{
  display:flex;
  justify-content:center;
  background:#1f6fa8;
  flex-wrap:wrap;
}
nav button{
  background:none;
  border:none;
  color:white;
  padding:12px 16px;
  cursor:pointer;
}
nav button:hover{background:#155a8a;}
section{display:none;padding:20px;}
section.activa{display:block}

/* ===== MALLA ===== */
.malla{
  display:flex;
  gap:18px;
  overflow-x:auto;
}
.anio{
  min-width:240px;
  background:white;
  padding:14px;
  border-radius:14px;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
}
.anio h3{
  text-align:center;
  color:#1f6fa8;
}
.materia{
  background:#e3f1ff;
  border:2px solid #8bbce8;
  border-radius:10px;
  padding:10px;
  margin-bottom:8px;
  cursor:pointer;
}
.materia.aprobada{
  background:#c9ead3;
  border-color:#5fb37c;
}
.materia small{
  display:block;
  font-size:12px;
  margin-top:4px;
}

/* ===== CALENDARIO ===== */
#calendar{
  max-width:900px;
  margin:auto;
  background:white;
  padding:15px;
  border-radius:14px;
}

/* ===== IA ===== */
.chat{
  max-width:700px;
  margin:auto;
}
.chat-box{
  background:white;
  padding:15px;
  height:300px;
  overflow-y:auto;
  border-radius:10px;
}
.msg{margin-bottom:8px;}
.user{color:#0b3c5d;font-weight:bold;}
.ia{color:#1f6fa8;}

/* ===== OTROS ===== */
.timer{font-size:48px;text-align:center;}
textarea{width:100%;height:220px;}
input[type=text]{width:80%;padding:8px;}
</style>
</head>

<body>

<header>
<h1>Medicina FMED ‚Äì Organizador</h1>
</header>

<nav>
<button onclick="mostrar('malla')">üìò Malla</button>
<button onclick="mostrar('calendario')">üìÖ Calendario</button>
<button onclick="mostrar('ia')">ü§ñ IA</button>
<button onclick="mostrar('pomodoro')">‚è± Pomodoro</button>
<button onclick="mostrar('horario')">üìù Horario</button>
</nav>

<!-- ================= MALLA ================= -->
<section id="malla" class="activa">
<div class="malla">

<div class="anio"><h3>CBC</h3>
<div class="materia" data-id="cbc-bio">Biolog√≠a</div>
<div class="materia" data-id="cbc-qui">Qu√≠mica</div>
<div class="materia" data-id="cbc-fis">F√≠sica</div>
<div class="materia" data-id="cbc-mat">Matem√°tica</div>
<div class="materia" data-id="cbc-pc">Pensamiento Cient√≠fico</div>
<div class="materia" data-id="cbc-se">Sociedad y Estado</div>
</div>

<div class="anio"><h3>1¬∞ A√±o</h3>
<div class="materia" data-id="anat">Anatom√≠a</div>
<div class="materia" data-id="histo">Histolog√≠a</div>
<div class="materia" data-id="biocel">Biolog√≠a Celular</div>
<div class="materia" data-id="embrio">Embriolog√≠a</div>
</div>

<div class="anio"><h3>2¬∞ A√±o</h3>
<div class="materia" data-id="fisio">Fisiolog√≠a</div>
<div class="materia" data-id="bioq">Bioqu√≠mica</div>
<div class="materia" data-id="micro">Microbiolog√≠a</div>
</div>

<div class="anio"><h3>3¬∞ A√±o</h3>
<div class="materia" data-id="pat">Patolog√≠a</div>
<div class="materia" data-id="farm">Farmacolog√≠a</div>
<div class="materia" data-id="meda">Medicina A</div>
</div>

<div class="anio"><h3>4¬∞ A√±o</h3>
<div class="materia" data-id="medb">Medicina B</div>
<div class="materia" data-id="cir">Cirug√≠a</div>
<div class="materia" data-id="pedi">Pediatr√≠a</div>
</div>

<div class="anio"><h3>5¬∞ A√±o</h3>
<div class="materia" data-id="gine">Ginecolog√≠a</div>
<div class="materia" data-id="psiq">Psiquiatr√≠a</div>
<div class="materia" data-id="legal">Medicina Legal</div>
</div>

<div class="anio"><h3>6¬∞ A√±o</h3>
<div class="materia" data-id="pfo">Pr√°ctica Final Obligatoria</div>
</div>

</div>
</section>

<!-- ================= CALENDARIO ================= -->
<section id="calendario">
<h2>Calendario de cursada</h2>
<div id="calendar"></div>
</section>

<!-- ================= IA ================= -->
<section id="ia">
<h2>Asistente de Medicina</h2>
<div class="chat">
<div class="chat-box" id="chat"></div>
<input type="text" id="pregunta" placeholder="Ej: ¬øC√≥mo estudiar fisiolog√≠a?">
<button onclick="responder()">Enviar</button>
</div>
</section>

<!-- ================= POMODORO ================= -->
<section id="pomodoro">
<h2>Pomodoro</h2>
<div class="timer" id="timer">25:00</div>
<button onclick="start()">Iniciar</button>
<button onclick="reset()">Reset</button>
</section>

<!-- ================= HORARIO ================= -->
<section id="horario">
<h2>Mi horario</h2>
<textarea id="horario"></textarea><br>
<button onclick="guardarHorario()">Guardar</button>
</section>

<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/main.min.js"></script>

<script>
/* ===== TABS ===== */
function mostrar(id){
  document.querySelectorAll("section").forEach(s=>s.classList.remove("activa"));
  document.getElementById(id).classList.add("activa");
}

/* ===== MALLA + NOTAS ===== */
document.querySelectorAll(".materia").forEach(m=>{
  const id=m.dataset.id;
  const data=JSON.parse(localStorage.getItem(id)||"{}");
  if(data.aprobada){
    m.classList.add("aprobada");
    if(data.nota) m.innerHTML+=`<small>Nota: ${data.nota}</small>`;
  }
  m.onclick=()=>{
    const nota=prompt("Nota final (1‚Äì10):");
    if(!nota) return;
    localStorage.setItem(id,JSON.stringify({aprobada:true,nota}));
    location.reload();
  }
});

/* ===== IA ===== */
function responder(){
  const q=pregunta.value.toLowerCase();
  chat.innerHTML+=`<div class="msg user">Vos: ${pregunta.value}</div>`;
  let r="Decime la materia y qu√© te preocupa.";

  if(q.includes("anatom")) r="Anatom√≠a se lleva con constancia diaria y atlas.";
  else if(q.includes("fisiolog")) r="Fisiolog√≠a es razonamiento. Entend√© mecanismos.";
  else if(q.includes("bioqu")) r="Bioqu√≠mica mejora mucho con esquemas.";
  else if(q.includes("dif√≠cil")||q.includes("dificil")) r="Las m√°s duras suelen ser Anatom√≠a, Fisio y Bioqu√≠mica.";

  chat.innerHTML+=`<div class="msg ia">IA: ${r}</div>`;
  chat.scrollTop=chat.scrollHeight;
  pregunta.value="";
}

/* ===== POMODORO ===== */
let t=1500,i;
function start(){
  clearInterval(i);
  i=setInterval(()=>{
    t--;
    timer.innerText=Math.floor(t/60)+":"+String(t%60).padStart(2,"0");
    if(t<=0)clearInterval(i);
  },1000);
}
function reset(){clearInterval(i);t=1500;timer.innerText="25:00";}

/* ===== HORARIO ===== */
horario.value=localStorage.getItem("horario")||"";
function guardarHorario(){localStorage.setItem("horario",horario.value);}

/* ===== CALENDARIO ===== */
document.addEventListener('DOMContentLoaded',()=>{
  const calendarEl=document.getElementById('calendar');
  const eventos=JSON.parse(localStorage.getItem("eventosFMED")||"[]");

  const calendar=new FullCalendar.Calendar(calendarEl,{
    initialView:'timeGridWeek',
    locale:'es',
    slotMinTime:"08:00:00",
    slotMaxTime:"22:00:00",
    selectable:true,
    editable:true,
    events:eventos,
    select(info){
      const t=prompt("Materia / actividad:");
      if(t){
        calendar.addEvent({title:t,start:info.start,end:info.end});
        guardar();
      }
      calendar.unselect();
    },
    eventClick(info){
      if(confirm("¬øEliminar evento?")){
        info.event.remove();
        guardar();
      }
    },
    eventChange:guardar
  });
  calendar.render();

  function guardar(){
    const ev=calendar.getEvents().map(e=>({
      title:e.title,start:e.start,end:e.end
    }));
